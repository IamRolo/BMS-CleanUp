(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{161:function(e,t,a){},165:function(e,t,a){},166:function(e,t,a){},167:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(12),i=a.n(s),l=(a(62),a(9)),o=a(1),c=a(2),m=a(3),u=a(6),h=a(5),p=a(4),d=(a(63),a(8)),f=(a(64),function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={active:n.props.active||!1},n}return Object(m.a)(a,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:this.props.id,className:"row collapse"+("true"==this.state.active?" show":""),"data-parent":this.props.dataParent},r.a.createElement("div",{className:"col-lg-12 mt-1"},this.props.children)))}}]),a}(r.a.Component)),b=(a(27),function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={active:n.props.active||!1},n}return Object(m.a)(a,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("a",{ref:this.props.buttonRef,className:"btn btn-large ml-3 white-text-button"+(this.state.active," btn-primary")+(!0===this.props.disabled?" disabled":""),href:this.props.controls,"aria-controls":this.props.controls,role:"button","data-toggle":"collapse","aria-expanded":this.state.active},r.a.createElement("i",{className:this.props.icon})," ",this.props.text))}}]),a}(r.a.Component)),g=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:this.props.width+" mx-auto",onClick:this.props.onClick},r.a.createElement("div",{className:"box shadow mt-3"+("light"===this.props.theme?" light-background":"")},this.props.children)))}}]),a}(r.a.Component),v=(a(65),function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).battery=r.a.createRef(),n.liquid=r.a.createRef(),n.liquidSvgAnimation=r.a.createRef(),n.batteryText=r.a.createRef(),n.batteryTextPercentage=r.a.createRef(),n.batteryTextUnits=r.a.createRef(),n.updateBattery=n.updateBattery.bind(Object(u.a)(n)),n}return Object(m.a)(a,[{key:"updateBattery",value:function(e){var t=Math.trunc(100*e);t<20?(this.liquidSvgAnimation.current.style.fill="red",this.battery.current.style.backgroundImage="linear-gradient(red 50%, #444 0%)"):t<50?(this.liquidSvgAnimation.current.style.fill="yellow",this.battery.current.style.backgroundImage="linear-gradient(yellow 50%, #444 0%)"):t<75?(this.liquidSvgAnimation.current.style.fill="chartreuse",this.battery.current.style.backgroundImage="linear-gradient(chartreuse 50%, #444 0%)"):(this.liquidSvgAnimation.current.style.fill="green",this.battery.current.style.backgroundImage="linear-gradient(green 50%, #444 0%)"),this.battery.current.style.backgroundPosition="0 -"+(100-t)+"%",this.batteryText.current.style.backgroundPosition="0 -"+(100-t)+"%",this.liquid.current.style.top=100-t+"%",this.liquid.current.style.backgroundColor=100===t?"green":"#444",this.batteryTextPercentage.current.innerText=(100*e).toFixed(1)}},{key:"componentDidUpdate",value:function(){this.props.soc&&this.updateBattery(this.props.soc)}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:this.props.id||"",style:Object(o.a)({position:"absolute"},this.props.positionStyle)},r.a.createElement("div",{ref:this.battery,className:"battery onscreen",style:Object(o.a)({},this.props.sizeStyle)},r.a.createElement("div",{ref:this.liquid,className:"liquid liquid-bg-color"},r.a.createElement("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",width:"300px",height:"5px",viewBox:"0 0 300 5",enableBackground:"new 0 0 300 5"},r.a.createElement("path",{ref:this.liquidSvgAnimation,className:"wave",d:"M300,300V2.5c0,0-0.6-0.1-1.1-0.1c0,0-25.5-2.3-40.5-2.4c-15,0-40.6,2.4-40.6,2.4\r c-12.3,1.1-30.3,1.8-31.9,1.9c-2-0.1-19.7-0.8-32-1.9c0,0-25.8-2.3-40.8-2.4c-15,0-40.8,2.4-40.8,2.4c-12.3,1.1-30.4,1.8-32,1.9\r c-2-0.1-20-0.8-32.2-1.9c0,0-3.1-0.3-8.1-0.7V300H300z"})))),r.a.createElement("div",{ref:this.batteryText,className:"battery-text onscreen"},this.props.isCharging&&r.a.createElement("span",{className:"isChargingIndicator"},r.a.createElement("i",{className:"fa fa-bolt"})),r.a.createElement("span",{ref:this.batteryTextPercentage,className:"percentage"}),r.a.createElement("small",{ref:this.batteryTextUnits,className:"units"},"%"))))}}]),a}(r.a.Component)),C=a(55),y=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={},n.data={labels:[],datasets:[{data:[],borderColor:"#008FFB",pointRadius:0,fill:!1,borderWidth:4}]},n.options={animation:{duration:1500,easing:"linear"},tooltips:{enabled:!1},legend:{display:!1},scales:{xAxes:[{gridLines:{color:"#90A4AE"},ticks:{fontColor:"white",beginAtZero:!0}}],yAxes:[{gridLines:{color:"#90A4AE",zeroLineColor:"#90A4AE"},ticks:{fontColor:"white"}}]},maintainAspectRatio:!1},n.chartReference=r.a.createRef(),n}return Object(m.a)(a,[{key:"componentDidUpdate",value:function(){var e,t,a,n,r,s=null===(e=this.props.data.labels)||void 0===e?void 0:e.length;(s>=12&&(this.chartReference.current.chartInstance.options.scales.xAxes[0].ticks.min=this.props.data.labels[s-1]-9,this.chartReference.current.chartInstance.options.scales.xAxes[0].ticks.max=this.props.data.labels[s-1]-1),this.chartReference.current.chartInstance.data.labels=this.props.data.labels,this.chartReference.current.chartInstance.data.datasets[0].data=this.props.data.values,!0===(null===(t=this.props.graphSettings)||void 0===t?void 0:t.graphAutoscaling))?(this.chartReference.current.chartInstance.options.scales.yAxes[0].ticks.min=void 0,this.chartReference.current.chartInstance.options.scales.yAxes[0].ticks.max=void 0):(this.chartReference.current.chartInstance.options.scales.yAxes[0].ticks.min=null===(n=this.props.setScales)||void 0===n?void 0:n.yAxes.min,this.chartReference.current.chartInstance.options.scales.yAxes[0].ticks.max=null===(r=this.props.setScales)||void 0===r?void 0:r.yAxes.max);!1===(null===(a=this.props.graphSettings)||void 0===a?void 0:a.graphAnimations)?this.chartReference.current.chartInstance.update(0):this.chartReference.current.chartInstance.update()}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,{ref:this.chartReference,data:this.data,options:Object(o.a)(Object(o.a)({},this.options),this.props.options)}))}}]),a}(r.a.Component),k=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"col-lg-6 text-right",style:{paddingRight:"0px",paddingLeft:"0px"}},r.a.createElement("span",{className:"custom-font mr-2 custom-light-weight"+("light"===this.props.theme?" text-dark":" text-white")},this.props.label," ")),r.a.createElement("div",{className:"col-lg-5 text-left align-self-center",style:{paddingRight:"0px",paddingLeft:"10px"}},r.a.createElement("span",{className:"custom-font"+("light"===this.props.theme?" text-dark":" text-white")},this.props.value),r.a.createElement("span",{className:"custom-font"+("light"===this.props.theme?" text-dark":" text-white")},this.props.units)))}}]),a}(r.a.Component),S=(a(161),function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"statusIndicator "+this.props.color+(this.props.blinking?"":" removedAnimations")}))}}]),a}(r.a.Component)),E=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row",style:{marginBottom:"5px"}},r.a.createElement("div",{className:"col d-flex justify-content-center text-center"},r.a.createElement(S,{color:this.props.color,blinking:this.props.blinking}))),r.a.createElement("div",{className:"row",style:{marginBottom:"10px"}},r.a.createElement("div",{className:"col d-flex justify-content-center text-center"},r.a.createElement("span",{className:"custom-font"+("light"===this.props.theme?" text-dark":" text-white")},this.props.text))))}}]),a}(r.a.Component),x=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12 text-center"},r.a.createElement("p",{className:"custom-font"+("light"===this.props.theme?" text-dark":" text-white"),style:{marginBottom:"3px",marginTop:"-15px"}},"Faults Status"))),r.a.createElement("div",{className:"row"},this.props.indicatorsNames.map((function(t,a){return r.a.createElement("div",{className:"col-md-3"},r.a.createElement(E,{text:t,color:e.props.boardConnected||e.props.demoModeActive?e.props.blinkingStatus[a]?"red":"green":"disabled",blinking:e.props.blinkingStatus[a],theme:e.props.theme}))}))))}}]),a}(r.a.Component),O=a(25),N=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).scrolabaleHistoryContainer=r.a.createRef(),n}return Object(m.a)(a,[{key:"componentDidUpdate",value:function(){this.scrolabaleHistoryContainer.current.scrollTop=this.scrolabaleHistoryContainer.current.scrollHeight}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(O.CSVLink,{data:this.props.history,filename:"BMS_faults_history.csv",style:{cursor:"text",color:"inherit",textDecoration:"none"}},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12 text-center"},r.a.createElement("p",{className:"custom-font"+("light"===this.props.theme?" text-dark":" text-white"),style:{marginBottom:"3px"},"data-toggle":"tooltip","data-placement":"top",title:"Click to download the history"},"Faults History ",r.a.createElement("i",{class:"fa fa-history ml-1","aria-hidden":"true"}))))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{ref:this.scrolabaleHistoryContainer,className:"col",style:{minHeight:"147px",maxHeight:"148px",overflowY:"auto"}},this.props.history.map((function(e,t){return r.a.createElement("div",{key:t,style:{minWidth:"inherit",color:1===e.to?"red":"green"}},e.time," - ",e.name+(1===e.to?" triggered":" cleared"))})))))}}]),a}(r.a.Component),V=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={},n}return Object(m.a)(a,[{key:"render",value:function(){var e,t=this.props.data.packSoC.length>0?this.props.data.packSoC[this.props.data.packSoC.length-1]:"0",a=this.props.data.packVoltage.length>0?this.props.data.packVoltage[this.props.data.packVoltage.length-1].toFixed(2):"0",n=this.props.data.packCurrent.length>0?this.props.data.packCurrent[this.props.data.packCurrent.length-1].toFixed(2):"0",s=this.props.data.packTemperature.length>0?this.props.data.packTemperature[this.props.data.packTemperature.length-1].toFixed(2):"0",i=this.props.data.packVoltage.length&this.props.data.packCurrent.length?(a*n).toFixed(2):"0";e=this.props.boardConnected?0===n?"Idle":n>0?"Charging":"Discharging":this.props.demoModeActive?"Demoing":"Disconnected";var l={xAxes:[{gridLines:{color:"#90A4AE"},ticks:{beginAtZero:!0,fontColor:"light"===this.props.theme?"black":"white"}}],yAxes:[{ticks:{fontColor:"light"===this.props.theme?"black":"white"},gridLines:{color:"#90A4AE",zeroLineColor:"#90A4AE"}}]};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row"},r.a.createElement(g,{width:"col-md-4",onClick:this.props.clickCellsPackTab,theme:this.props.theme},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12 text-center"},r.a.createElement("p",{className:"custom-font"+("light"===this.props.theme?" text-dark":" text-white"),style:{marginBottom:"0px"}},"Summary"))),r.a.createElement("div",{className:"row",style:{marginTop:"38px",marginBottom:"27px"}},r.a.createElement("div",{className:"col-md-3"},r.a.createElement(v,{id:"dashboardBattery",positionStyle:{top:"178px",left:"60px"},sizeStyle:{width:"95px",height:"195px"},isCharging:n>0,soc:t})),r.a.createElement("div",{className:"col-md-7 offset-md-1"},r.a.createElement("div",{className:"row mt-4"},r.a.createElement(k,{label:"State of charge",value:"0"===t?0:(100*t).toFixed(2)||0,units:this.props.units.systemSocUnits,theme:this.props.theme})),r.a.createElement("div",{className:"row mt-2"},r.a.createElement(k,{label:"Voltage",value:a,units:this.props.units.systemVoltageUnits,theme:this.props.theme})),r.a.createElement("div",{className:"row mt-2"},r.a.createElement(k,{label:"Current",value:n,units:this.props.units.systemCurrentUnits,theme:this.props.theme})),r.a.createElement("div",{className:"row mt-2"},r.a.createElement(k,{label:"Temperature",value:s,units:this.props.units.systemTempUnits,theme:this.props.theme})),r.a.createElement("div",{className:"row mt-2"},r.a.createElement(k,{label:"Power",value:i,units:this.props.units.systemPowerUnits,theme:this.props.theme})),r.a.createElement("div",{className:"row mt-2"},r.a.createElement(k,{label:"Status",value:e,units:"",theme:this.props.theme}))))),r.a.createElement(g,{width:"col-md-8",theme:this.props.theme},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6",style:{minHeight:"295px"}},r.a.createElement(y,{data:{labels:this.props.data.labels,values:this.props.data.packVoltage},options:{title:{display:!0,text:"Pack Voltage "+"(".concat(this.props.units.systemVoltageUnits,")"),fontColor:"light"===this.props.theme?"black":"white",fontSize:14,padding:5},scales:l},setScales:{yAxes:{min:this.props.units.axis.voltage[this.props.units.systemVoltageUnits].min*this.props.cellsNumber,max:this.props.units.axis.voltage[this.props.units.systemVoltageUnits].max*this.props.cellsNumber}},graphSettings:this.props.graphSettings})),r.a.createElement("div",{className:"col-md-6",style:{minHeight:"295px"}},r.a.createElement(y,{data:{labels:this.props.data.labels,values:this.props.data.packCurrent},options:{title:{display:!0,text:"Pack Current "+"(".concat(this.props.units.systemCurrentUnits,")"),fontColor:"light"===this.props.theme?"black":"white",fontSize:14,padding:5},scales:l},setScales:{yAxes:{min:this.props.units.axis.current[this.props.units.systemCurrentUnits].min*this.props.cellsNumber,max:this.props.units.axis.current[this.props.units.systemCurrentUnits].max*this.props.cellsNumber}},graphSettings:this.props.graphSettings}))))),r.a.createElement("div",{className:"row"},r.a.createElement(g,{width:"col-md-7",theme:this.props.theme},r.a.createElement(x,{indicatorsNames:this.props.indicatorsNames,blinkingStatus:this.props.blinkingStatus,boardConnected:this.props.boardConnected,demoModeActive:this.props.demoModeActive,theme:this.props.theme})),r.a.createElement(g,{width:"col-md-5",theme:this.props.theme},r.a.createElement(N,{history:this.props.indicatorsHistory,theme:this.props.theme}))))}}]),a}(r.a.Component),P=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:this.props.width+" mx-auto"},r.a.createElement("div",{className:"box shadow mt-3"+("light"===this.props.theme?" light-background":""),style:{paddingLeft:"0px",paddingRight:"10px",paddingBottom:"0px",paddingTop:"10px"}},this.props.children)))}}]),a}(r.a.Component),D=a(26),R=a.n(D),w=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).dropdownContextMenu=r.a.createRef(),n.voltageOption=r.a.createRef(),n.curentOption=r.a.createRef(),n.tempOption=r.a.createRef(),n.selectedOption=r.a.createRef(),n.voltageChartContainer=r.a.createRef(),n.currentChartContainer=r.a.createRef(),n.temperatureChartContainer=r.a.createRef(),n.balancingChartContainer=r.a.createRef(),n.state={visible:!1,selectedToShow:"Voltage",units:n.props.units.systemVoltageUnits},n.chartReference=r.a.createRef(),n.contextMenuOpen=n.contextMenuOpen.bind(Object(u.a)(n)),n.menuOptionChange=n.menuOptionChange.bind(Object(u.a)(n)),n.adjustToSystemUnits=n.adjustToSystemUnits.bind(Object(u.a)(n)),n.visibilityChange=n.visibilityChange.bind(Object(u.a)(n)),n}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=this;document.body.addEventListener("click",(function(){e.dropdownContextMenu.current&&(e.dropdownContextMenu.current.classList.remove("show"),e.dropdownContextMenu.current.style.display="none")})),document.body.addEventListener("contextmenu",(function(){e.dropdownContextMenu.current&&(e.dropdownContextMenu.current.classList.remove("show"),e.dropdownContextMenu.current.style.display="none")}))}},{key:"contextMenuOpen",value:function(e){var t=e.clientY,a=e.clientX;this.dropdownContextMenu.current.style.top=t+"px",this.dropdownContextMenu.current.style.left=a+"px",this.dropdownContextMenu.current.style.display="block",this.dropdownContextMenu.current.classList.add("show"),e.preventDefault()}},{key:"menuOptionChange",value:function(e){switch(this.voltageOption.current.classList.remove("active"),this.curentOption.current.classList.remove("active"),this.tempOption.current.classList.remove("active"),e.target.classList.add("active"),e.target.innerText){case"Voltage":this.voltageChartContainer.current.style.display="block",this.currentChartContainer.current.style.display="none",this.temperatureChartContainer.current.style.display="none",this.balancingChartContainer.current.style.display="none",this.setState((function(){return{selectedToShow:"Voltage"}}));break;case"Current":this.voltageChartContainer.current.style.display="none",this.currentChartContainer.current.style.display="block",this.temperatureChartContainer.current.style.display="none",this.balancingChartContainer.current.style.display="none",this.setState((function(){return{selectedToShow:"Current"}}));break;case"Temperature":this.voltageChartContainer.current.style.display="none",this.currentChartContainer.current.style.display="none",this.temperatureChartContainer.current.style.display="block",this.balancingChartContainer.current.style.display="none",this.setState((function(){return{selectedToShow:"Temperature"}}));break;case"Balancing":this.voltageChartContainer.current.style.display="none",this.currentChartContainer.current.style.display="none",this.temperatureChartContainer.current.style.display="none",this.balancingChartContainer.current.style.display="block",this.setState((function(){return{selectedToShow:"Balancing"}}))}}},{key:"shouldComponentUpdate",value:function(e,t){return this.props.theme!==e.theme||this.props.cellsNumber<=6||this.state.visible}},{key:"adjustToSystemUnits",value:function(){switch(this.state.selectedToShow){case"Voltage":this.state.units=this.props.units.systemVoltageUnits;break;case"Current":this.state.units=this.props.units.systemCurrentUnits;break;case"Temperature":this.state.units=this.props.units.systemTempUnits;break;default:this.state.units=""}}},{key:"visibilityChange",value:function(e){this.setState((function(){return{visible:e}}))}},{key:"render",value:function(){var e,t,a,n,s,i,l,c,m,u,h,p,d,f,b,g,C,k,S={scales:{xAxes:[{gridLines:{color:"#90A4AE"},ticks:{beginAtZero:!0,fontColor:"light"===this.props.theme?"black":"white"}}],yAxes:[{ticks:{fontColor:"light"===this.props.theme?"black":"white"},gridLines:{color:"#90A4AE",zeroLineColor:"#90A4AE"}}]}};return this.adjustToSystemUnits(),r.a.createElement(R.a,{onChange:this.visibilityChange},r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{onContextMenu:this.contextMenuOpen,className:"row","data-toggle":"modal","data-target":"#bateryModal"+this.props.id},r.a.createElement("div",{className:"col-md-12 text-center"},r.a.createElement("p",{className:"custom-font"+("light"===this.props.theme?" text-dark":" text-white")},"Cell ",this.props.id+1," ",r.a.createElement("span",{ref:this.selectedOption},this.state.selectedToShow," ",this.state.units&&"("),r.a.createElement("span",null,this.state.units,this.state.units&&")")))),r.a.createElement("div",{onContextMenu:this.contextMenuOpen,className:"row","data-toggle":"modal","data-target":"#bateryModal"+this.props.id},r.a.createElement("div",{className:"col-md-3"},r.a.createElement(v,{positionStyle:{top:"190px",left:"75px"},isCharging:(null===(e=this.props.cellData)||void 0===e?void 0:e.current[(null===(t=this.props.cellData)||void 0===t?void 0:t.current.length)-1])>0,soc:null===(a=this.props.cellData)||void 0===a?void 0:a.soc[(null===(n=this.props.cellData)||void 0===n?void 0:n.soc.length)-1]})),r.a.createElement("div",{className:"col-md-9 text-center"},r.a.createElement("div",{ref:this.voltageChartContainer,style:{minHeight:"230px"}},r.a.createElement(y,{data:{labels:null===(s=this.props.cellData)||void 0===s?void 0:s.labels,values:null===(i=this.props.cellData)||void 0===i?void 0:i.voltage},options:S,setScales:{yAxes:{min:this.props.units.axis.voltage[this.props.units.systemVoltageUnits].min,max:this.props.units.axis.voltage[this.props.units.systemVoltageUnits].max}},graphSettings:this.props.graphSettings})),r.a.createElement("div",{ref:this.currentChartContainer,style:{display:"none",minHeight:"230px"}},r.a.createElement(y,{data:{labels:null===(l=this.props.cellData)||void 0===l?void 0:l.labels,values:null===(c=this.props.cellData)||void 0===c?void 0:c.current},options:S,setScales:{yAxes:{min:this.props.units.axis.current[this.props.units.systemCurrentUnits].min,max:this.props.units.axis.current[this.props.units.systemCurrentUnits].max}},graphSettings:this.props.graphSettings})),r.a.createElement("div",{ref:this.balancingChartContainer,style:{display:"none",minHeight:"230px"}},r.a.createElement(y,{data:{labels:null===(m=this.props.cellData)||void 0===m?void 0:m.labels,values:null===(u=this.props.cellData)||void 0===u?void 0:u.balancing},options:S,setScales:{yAxes:{min:this.props.units.axis.balancing.min,max:this.props.units.axis.balancing.max}},graphSettings:this.props.graphSettings})),r.a.createElement("div",{ref:this.temperatureChartContainer,style:{display:"none",minHeight:"230px"}},r.a.createElement(y,{data:{labels:null===(h=this.props.cellData)||void 0===h?void 0:h.labels,values:null===(p=this.props.cellData)||void 0===p?void 0:p.temp},options:S,setScales:{yAxes:{min:this.props.units.axis.temp[this.props.units.systemTempUnits].min,max:this.props.units.axis.temp[this.props.units.systemTempUnits].max}},graphSettings:this.props.graphSettings})))),r.a.createElement("div",{ref:this.dropdownContextMenu,className:"dropdown-menu dropdown-menu-sm custom-context-menu"},r.a.createElement("a",{className:"dropdown-item active",ref:this.voltageOption,onClick:this.menuOptionChange},"Voltage"),r.a.createElement("a",{className:"dropdown-item",ref:this.curentOption,onClick:this.menuOptionChange},"Balancing"),r.a.createElement("a",{className:"dropdown-item",ref:this.tempOption,onClick:this.menuOptionChange},"Temperature")),r.a.createElement("div",{className:"modal fade",id:"bateryModal"+this.props.id,tabIndex:"-1",role:"dialog","aria-labelledby":"bateryModalLabel"+this.props.id,"aria-hidden":"true"},r.a.createElement("div",{className:"modal-dialog",role:"document",style:{maxWidth:"1100px"}},r.a.createElement("div",{className:"modal-content"+("light"===this.props.theme?" light-background":"")},r.a.createElement("div",{className:"modal-header"},r.a.createElement("h5",{className:"modal-title"+("light"===this.props.theme?" text-dark":" text-white"),id:"bateryModalLabel"+this.props.id},"Cell ",this.props.id+1," details"),r.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"})),r.a.createElement("div",{className:"modal-body"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-lg-4",style:{minHeight:"400px"}},r.a.createElement(y,{data:{labels:null===(d=this.props.cellData)||void 0===d?void 0:d.labels,values:null===(f=this.props.cellData)||void 0===f?void 0:f.voltage},options:Object(o.a)(Object(o.a)({},S),{},{title:{display:!0,text:"Cell Voltage "+"(".concat(this.props.units.systemVoltageUnits,")"),fontColor:"light"===this.props.theme?"black":"white",fontSize:"14"}}),setScales:{yAxes:{min:this.props.units.axis.voltage[this.props.units.systemVoltageUnits].min,max:this.props.units.axis.voltage[this.props.units.systemVoltageUnits].max}},graphSettings:this.props.graphSettings})),r.a.createElement("div",{className:"col-lg-4",style:{minHeight:"400px"}},r.a.createElement(y,{data:{labels:null===(b=this.props.cellData)||void 0===b?void 0:b.labels,values:null===(g=this.props.cellData)||void 0===g?void 0:g.balancing},options:Object(o.a)(Object(o.a)({},S),{},{title:{display:!0,text:"Cell Balancing ",fontColor:"light"===this.props.theme?"black":"white",fontSize:"14"}}),setScales:{yAxes:{min:this.props.units.axis.balancing.min,max:this.props.units.axis.balancing.max}},graphSettings:this.props.graphSettings})),r.a.createElement("div",{className:"col-lg-4",style:{minHeight:"400px"}},r.a.createElement(y,{data:{labels:null===(C=this.props.cellData)||void 0===C?void 0:C.labels,values:null===(k=this.props.cellData)||void 0===k?void 0:k.temp},options:Object(o.a)(Object(o.a)({},S),{},{title:{display:!0,text:"Cell Temperature "+"(".concat(this.props.units.systemTempUnits,")"),fontColor:"light"===this.props.theme?"black":"white",fontSize:"14"}}),setScales:{yAxes:{min:this.props.units.axis.temp[this.props.units.systemTempUnits].min,max:this.props.units.axis.temp[this.props.units.systemTempUnits].max}},graphSettings:this.props.graphSettings})))))))))}}]),a}(r.a.Component),A=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row"},Object(l.a)(Array(this.props.cellsNumber).keys()).map((function(t){return r.a.createElement(P,{key:t,width:"col-md-4",theme:e.props.theme},r.a.createElement(w,{id:t,cellsNumber:e.props.cellsNumber,cellData:e.props.cellsData[t],units:e.props.units,theme:e.props.theme,boardConnected:e.props.boardConnected,demoModeActive:e.props.demoModeActive,graphSettings:e.props.graphSettings}))}))))}}]),a}(r.a.Component),j=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("tr",null,r.a.createElement("td",{scope:"row"},"Cell ",this.props.id+1),this.props.values&&this.props.values.length>0?r.a.createElement("td",null,this.props.values[this.props.values.length-1].toFixed(this.props.noDecimals?0:2)):"0",this.props.units&&r.a.createElement("td",null,this.props.units)))}}]),a}(r.a.Component),T=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("table",{className:"table table-striped table-sm text-center"+("light"===this.props.theme?"":" table-dark")},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{scope:"col"},"Name"),r.a.createElement("th",{scope:"col"},"Value"),this.props.units&&r.a.createElement("th",{scope:"col"},"Units"))),r.a.createElement("tbody",null,Object(l.a)(Array(this.props.cellsNumber).keys()).map((function(t){return r.a.createElement(j,{id:t,key:t,name:e.props.name,noDecimals:e.props.noDecimals,values:e.props.cellsData[t],units:e.props.units})})))))}}]),a}(r.a.Component),U=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={visible:!1},n.visibilityChange=n.visibilityChange.bind(Object(u.a)(n)),n}return Object(m.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){return this.props.theme!==e.theme||this.state.visible}},{key:"visibilityChange",value:function(e){this.setState((function(){return{visible:e}}))}},{key:"render",value:function(){return r.a.createElement(R.a,{onChange:this.visibilityChange,partialVisibility:!0},r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row"},r.a.createElement(g,{width:"col-md-4",theme:this.props.theme},r.a.createElement("div",{className:"row"},r.a.createElement("span",{className:"badge badge-primary ml-2 mb-2",style:{fontSize:"22px"}},r.a.createElement("i",{className:"fa fa-bolt mr-2"}),"Voltage")),r.a.createElement("div",{className:"row"},r.a.createElement(T,{cellsNumber:this.props.cellsNumber,cellsData:this.props.cellsData.map((function(e){return e.voltage})),name:"Voltage",units:this.props.units.systemVoltageUnits,theme:this.props.theme}))),r.a.createElement(g,{width:"col-md-4",theme:this.props.theme},r.a.createElement("div",{className:"row"},r.a.createElement("span",{className:"badge badge-primary ml-2 mb-2",style:{fontSize:"22px"}},r.a.createElement("i",{className:"fa fa-thermometer-half mr-2"}),"Temperature")),r.a.createElement("div",{className:"row"},r.a.createElement(T,{cellsNumber:this.props.cellsNumber,cellsData:this.props.cellsData.map((function(e){return e.temp})),name:"Temperature",units:this.props.units.systemTempUnits,theme:this.props.theme}))),r.a.createElement(g,{width:"col-md-4",theme:this.props.theme},r.a.createElement("div",{className:"row"},r.a.createElement("span",{className:"badge badge-primary ml-2 mb-2",style:{fontSize:"22px"}},r.a.createElement("i",{className:"fa fa-balance-scale mr-2"}),"Balancing")),r.a.createElement("div",{className:"row"},r.a.createElement(T,{cellsNumber:this.props.cellsNumber,cellsData:this.props.cellsData.map((function(e){return e.balancing})),name:"Balancing",noDecimals:!0,units:"",theme:this.props.theme}))))))}}]),a}(r.a.Component),M=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={freemasterVersion:"lite"},n.liteServerUrlInput=r.a.createRef(),n.connStringInput=r.a.createRef(),n.elfPathInput=r.a.createRef(),n.onInputChange=n.onInputChange.bind(Object(u.a)(n)),n.onelfPathInputChange=n.onelfPathInputChange.bind(Object(u.a)(n)),n}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.liteServerUrlInput.current.defaultValue=this.props.liteConnection.liteServerUrl,this.connStringInput.current.defaultValue=this.props.liteConnection.connString,this.elfPathInput.current.defaultValue=this.props.elfPath}},{key:"componentDidUpdate",value:function(){"desktop"===this.state.freemasterVersion&&(this.liteServerUrlInput.current.defaultValue="localhost:41000",this.connStringInput.current.defaultValue="Managed from Desktop Application",this.elfPathInput.current.defaultValue="Managed from Desktop Application"),"lite"===this.state.freemasterVersion&&(this.liteServerUrlInput.current.defaultValue="localhost:8090",this.connStringInput.current.defaultValue="RS232;port=COM14;speed=115200;",this.elfPathInput.current.defaultValue="bms\\BMS_NXP.elf")}},{key:"onInputChange",value:function(){this.props.changeLiteConnection({liteServerUrl:this.liteServerUrlInput.current.value,connString:this.connStringInput.current.value})}},{key:"onelfPathInputChange",value:function(){this.props.changeElfPath(this.elfPathInput.current.value)}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("form",null,r.a.createElement("label",null,"Freemaster Version"),r.a.createElement("div",{className:"form-row mb-2"},r.a.createElement("div",{className:"col text-center mx-auto"},r.a.createElement("div",{className:"form-check-inline"},r.a.createElement("input",{className:"form-check-input",type:"radio",name:"freemasterVersion",id:"desktopRadio",value:"desktop",onClick:function(){e.setState({freemasterVersion:"desktop"}),e.props.onSelectedFreemasterVersion("desktop")}}),r.a.createElement("label",{className:"form-check-label",htmlFor:"desktopRadio"},"Desktop")),r.a.createElement("div",{className:"form-check-inline"},r.a.createElement("input",{className:"form-check-input",type:"radio",name:"freemasterVersion",id:"liteRadio",value:"lite",defaultChecked:!0,onClick:function(){e.setState({freemasterVersion:"lite"}),e.props.onSelectedFreemasterVersion("lite"),e.props.changeLiteConnection({liteServerUrl:"localhost:8090",connString:"RS232;port=COM14;speed=115200;"}),e.props.changeElfPath("bms\\BMS_NXP.elf")}}),r.a.createElement("label",{className:"form-check-label",htmlFor:"liteRadio"},"Lite")))),r.a.createElement("label",null,"Freemaster Server URL"),r.a.createElement("div",{className:"form-row"},r.a.createElement("div",{className:"input-group mb-1"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text",id:"server-addon"},r.a.createElement("i",{className:"fa fa-server"}))),r.a.createElement("input",{ref:this.liteServerUrlInput,type:"text",disabled:"desktop"===this.state.freemasterVersion,onChange:this.onInputChange,className:"form-control",placeholder:"Freemaster Server URL (ex:localhost:8090)","aria-label":"Server","aria-describedby":"server-addon"}))),r.a.createElement("label",null,"Connection String"),r.a.createElement("div",{className:"form-row"},r.a.createElement("div",{className:"input-group mb-1"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text",id:"connstring-addon"},r.a.createElement("i",{className:"fa fa-plug"}))),r.a.createElement("input",{ref:this.connStringInput,type:"text",disabled:"desktop"===this.state.freemasterVersion,onChange:this.onInputChange,className:"form-control",placeholder:"Connection String (ex:RS232;port=COM3;speed=115200;)","aria-label":"ConnectionString","aria-describedby":"connstring-addon"}))),r.a.createElement("label",null,"ELF File"),r.a.createElement("div",{className:"form-row"},r.a.createElement("div",{className:"input-group"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text",id:"elfpath-addon"},r.a.createElement("i",{className:"fa fa-file"}))),r.a.createElement("input",{ref:this.elfPathInput,type:"text",disabled:"desktop"===this.state.freemasterVersion,onChange:this.onelfPathInputChange,className:"form-control",placeholder:"ex: bms_s32k.elf","aria-label":"ElfPath","aria-describedby":"elfpath-addon"})))))}}]),a}(r.a.Component),I=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("form",null,r.a.createElement("label",null,"Recorded Parameters"),r.a.createElement("div",{className:"form-row"},r.a.createElement("div",{className:"col text-center mx-auto"},r.a.createElement("div",{className:"form-check-inline"},r.a.createElement("input",{className:"form-check-input",type:"checkbox",name:"recordedParams",id:"voltageCheckbox",value:"voltage",defaultChecked:!0,onClick:function(){return e.props.onSelectedRecordParamsToggle("voltage")}}),r.a.createElement("label",{className:"form-check-label",htmlFor:"voltageCheckbox"},"Voltage")),r.a.createElement("div",{className:"form-check-inline"},r.a.createElement("input",{className:"form-check-input",type:"checkbox",name:"recordedParams",id:"currentCheckbox",value:"current",defaultChecked:!0,onClick:function(){return e.props.onSelectedRecordParamsToggle("current")}}),r.a.createElement("label",{className:"form-check-label",htmlFor:"currentCheckbox"},"Current")),r.a.createElement("div",{className:"form-check-inline"},r.a.createElement("input",{className:"form-check-input",type:"checkbox",name:"recordedParams",id:"temperatureCheckbox",value:"temperature",defaultChecked:!0,onClick:function(){return e.props.onSelectedRecordParamsToggle("temperature")}}),r.a.createElement("label",{className:"form-check-label",htmlFor:"temperatureCheckbox"},"Temperature")),r.a.createElement("div",{className:"form-check-inline"},r.a.createElement("input",{className:"form-check-input",type:"checkbox",name:"recordedParams",id:"socCheckbox",value:"soc",defaultChecked:!0,onClick:function(){return e.props.onSelectedRecordParamsToggle("soc")}}),r.a.createElement("label",{className:"form-check-label",htmlFor:"socCheckbox"},"SoC"))))))}}]),a}(r.a.Component),F=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(e){return Object(c.a)(this,a),t.call(this,e)}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"form-row"},r.a.createElement("div",{className:"col text-center mx-auto"},r.a.createElement("div",{className:"form-check-inline"},r.a.createElement("input",{className:"form-check-input",type:"checkbox",name:"chartParams",id:"autoScalingCheckbox",value:"autoScaling",defaultChecked:!0,onClick:function(){return e.props.onToggleAutoScaling()}}),r.a.createElement("label",{className:"form-check-label",htmlFor:"autoScalingCheckbox"},"Auto scaling axes")),r.a.createElement("div",{className:"form-check-inline"},r.a.createElement("input",{className:"form-check-input",type:"checkbox",name:"chartParams",id:"animationsCheckbox",value:"animations",defaultChecked:!0,onClick:function(){return e.props.onToggleAnimations()}}),r.a.createElement("label",{className:"form-check-label",htmlFor:"animationsCheckbox"},"Animations")))))}}]),a}(r.a.Component),B=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={cellsNr:6,selectedRecordParam:{voltage:!0,current:!0,temperature:!0,soc:!0},recordedData:[["voltage","current","temperature","soc"]]},n.cellsNumberSelect=r.a.createRef(),n.onChangeCellsNumber=n.onChangeCellsNumber.bind(Object(u.a)(n)),n.onChangeUnits=n.onChangeUnits.bind(Object(u.a)(n)),n.formatRecordedData=n.formatRecordedData.bind(Object(u.a)(n)),n}return Object(m.a)(a,[{key:"onChangeUnits",value:function(e){this.props.changeUnit(e.target.value)}},{key:"onChangeCellsNumber",value:function(e){Number(this.cellsNumberSelect.current.value)&&Number(this.cellsNumberSelect.current.value)!=this.state.cellsNr&&(this.state.cellsNr=Number(this.cellsNumberSelect.current.value),this.props.changeCellsNumber(Number(this.cellsNumberSelect.current.value))),e.preventDefault()}},{key:"formatRecordedData",value:function(){var e,t=[[]];t[0].push("Time"),this.state.selectedRecordParam.voltage&&t[0].push("BMS voltage ("+this.props.units.systemVoltageUnits+")"),this.state.selectedRecordParam.current&&t[0].push("BMS current ("+this.props.units.systemCurrentUnits+")"),this.state.selectedRecordParam.temperature&&t[0].push("BMS temperature ("+this.props.units.systemTempUnits+")"),this.state.selectedRecordParam.soc&&t[0].push("BMS SoC ("+this.props.units.systemSocUnits+")");for(var a=1;a<=this.props.cellsNumber;a++)this.state.selectedRecordParam.voltage&&t[0].push("Cell "+a+" voltage ("+this.props.units.systemVoltageUnits+")"),this.state.selectedRecordParam.current&&t[0].push("Cell "+a+" current ("+this.props.units.systemCurrentUnits+")"),this.state.selectedRecordParam.temperature&&t[0].push("Cell "+a+" temperature ("+this.props.units.systemTempUnits+")"),this.state.selectedRecordParam.soc&&t[0].push("Cell "+a+" SoC ("+this.props.units.systemSocUnits+")");for(var n=this.props.cellsData,r=(null===(e=n[0])||void 0===e?void 0:e.labels.length)||0,s=0;s<r;s++){t.push([]),t[s+1].push(n[0].labels[s]),this.state.selectedRecordParam.voltage&&t[s+1].push(this.props.data.packVoltage[s]),this.state.selectedRecordParam.current&&t[s+1].push(this.props.data.packCurrent[s]),this.state.selectedRecordParam.temperature&&t[s+1].push(this.props.data.packTemperature[s]),this.state.selectedRecordParam.soc&&t[s+1].push(this.props.data.packSoC[s]);for(var i=0;i<this.props.cellsNumber;i++)this.state.selectedRecordParam.voltage&&t[s+1].push(n[i].voltage[s]),this.state.selectedRecordParam.current&&t[s+1].push(n[i].current[s]),this.state.selectedRecordParam.temperature&&t[s+1].push(n[i].temp[s]),this.state.selectedRecordParam.soc&&t[s+1].push(n[i].soc[s])}this.setState((function(){return{recordedData:t}})),d.b.info(" Data exported.",{autoClose:3e3})}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-lg-4"},r.a.createElement("div",{className:"row"},r.a.createElement(g,{width:"col-md-12",theme:this.props.theme},r.a.createElement("p",{className:"custom-font text-center"+("light"===this.props.theme?" text-dark":" text-white"),style:{marginBottom:"10px"}},"BMS Parameters"),r.a.createElement("form",null,r.a.createElement("label",null,"Filter used to determine SOC"),r.a.createElement("div",{className:"form-row"},r.a.createElement("select",{className:"form-control mx-auto"},r.a.createElement("option",{defaultValue:!0},"Select the filter used to determine SOC"),r.a.createElement("option",{value:"1"},"Coloumb Counting"),r.a.createElement("option",{value:"2"},"UKF"),r.a.createElement("option",{value:"3"},"EKF"))),r.a.createElement("label",{className:"mt-3"},"Number of Cells"),r.a.createElement("div",{className:"form-row"},r.a.createElement("select",{ref:this.cellsNumberSelect,onClick:this.onChangeCellsNumber,className:"form-control mx-auto"},r.a.createElement("option",{defaultValue:!0,value:"0"},"Select the number of cells"),Object(l.a)(Array(25).keys()).map((function(e){return r.a.createElement("option",{value:e+4,key:e},e+4)})))))),r.a.createElement(g,{width:"col-md-12",theme:this.props.theme},r.a.createElement("p",{className:"custom-font text-center"+("light"===this.props.theme?" text-dark":" text-white"),style:{marginBottom:"10px"}},"Data recording options"),r.a.createElement(I,{onSelectedRecordParamsToggle:function(t){switch(t){case"voltage":e.setState((function(e){return{selectedRecordParam:Object(o.a)(Object(o.a)({},e.selectedRecordParam),{},{voltage:!e.selectedRecordParam.voltage})}}));break;case"current":e.setState((function(e){return{selectedRecordParam:Object(o.a)(Object(o.a)({},e.selectedRecordParam),{},{current:!e.selectedRecordParam.current})}}));break;case"temperature":e.setState((function(e){return{selectedRecordParam:Object(o.a)(Object(o.a)({},e.selectedRecordParam),{},{temperature:!e.selectedRecordParam.temperature})}}));break;case"soc":e.setState((function(e){return{selectedRecordParam:Object(o.a)(Object(o.a)({},e.selectedRecordParam),{},{soc:!e.selectedRecordParam.soc})}}))}}}),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col text-center"},r.a.createElement(O.CSVLink,{data:this.state.recordedData,filename:"BMS_recorded_parameters.csv",onClick:this.formatRecordedData,className:"btn btn-primary mt-4"},"Get recorded data")))))),r.a.createElement("div",{className:"col-lg-4"},r.a.createElement("div",{className:"row"},r.a.createElement(g,{width:"col-md-12",theme:this.props.theme},r.a.createElement("p",{className:"custom-font text-center"+("light"===this.props.theme?" text-dark":" text-white"),style:{marginBottom:"10px"}},"BMS Measurement Units"),r.a.createElement("label",null,"Voltage Units of Measure"),r.a.createElement("div",{className:"form-row"},r.a.createElement("select",{onClick:this.onChangeUnits,className:"form-control mx-auto"},r.a.createElement("option",{defaultValue:!0},"Select the Voltage Units of Measure"),r.a.createElement("option",{value:"uV"},"\xb5V"),r.a.createElement("option",{value:"mV"},"mV"),r.a.createElement("option",{value:"V"},"V"))),r.a.createElement("label",{className:"mt-3"},"Current Units of Measure"),r.a.createElement("div",{className:"form-row"},r.a.createElement("select",{onClick:this.onChangeUnits,className:"form-control mx-auto"},r.a.createElement("option",{defaultValue:!0},"Select the Current Units of Measure"),r.a.createElement("option",{value:"uA"},"\xb5A"),r.a.createElement("option",{value:"mA"},"mA"),r.a.createElement("option",{value:"A"},"A"))),r.a.createElement("label",{className:"mt-3"},"Temperature Units of Measure"),r.a.createElement("div",{className:"form-row"},r.a.createElement("select",{onClick:this.onChangeUnits,className:"form-control mx-auto"},r.a.createElement("option",{defaultValue:!0},"Select the Temperature Units of Measure"),r.a.createElement("option",{value:"C"},"\xb0C"),r.a.createElement("option",{value:"F"},"\xb0F"),r.a.createElement("option",{value:"K"},"K")))),r.a.createElement(g,{width:"col-md-12",theme:this.props.theme},r.a.createElement("p",{className:"custom-font text-center"+("light"===this.props.theme?" text-dark":" text-white"),style:{marginBottom:"10px"}},"Application Settings"),r.a.createElement("div",{className:"form-row"},r.a.createElement("div",{className:"col text-center mx-auto mt-3"},r.a.createElement("div",{className:"form-check"},r.a.createElement("input",{onClick:this.props.triggerDemoMode,disabled:this.props.boardConnected,id:"demoModeCheckbox",className:"form-check-input",type:"checkbox"}),r.a.createElement("label",{className:"form-check-label",htmlFor:"demoModeCheckbox"},"Demo Mode ",this.props.demoModeActive?" (active)":" (disabled)")))),r.a.createElement("div",{className:"form-row"},r.a.createElement("div",{className:"col text-center mx-auto mt-4"},r.a.createElement("div",{className:"form-check"},r.a.createElement("input",{className:"form-check-input",type:"radio",name:"themeRadios",id:"darkThemeRadio",value:"darkTheme",defaultChecked:!0,onClick:function(){document.body.style.background="#343E59",e.props.changeApplicationTheme("dark")}}),r.a.createElement("label",{className:"form-check-label",htmlFor:"darkThemeRadio"},"Dark Theme")),r.a.createElement("div",{className:"form-check"},r.a.createElement("input",{className:"form-check-input",type:"radio",name:"themeRadios",id:"lightThemeRadio",value:"lightTheme",onClick:function(){document.body.style.background="#e7eff6",e.props.changeApplicationTheme("light")}}),r.a.createElement("label",{className:"form-check-label",htmlFor:"lightThemeRadio"},"Light Theme"))))))),r.a.createElement("div",{className:"col-lg-4"},r.a.createElement("div",{className:"row"},r.a.createElement(g,{width:"col-md-12",theme:this.props.theme},r.a.createElement("p",{className:"custom-font text-center"+("light"===this.props.theme?" text-dark":" text-white"),style:{marginBottom:"10px"}},"Connection Parameters"),r.a.createElement(M,{pcm:this.state.pcm,boardConnected:this.props.boardConnected,demoModeActive:this.props.demoModeActive,loading:this.props.loading,liteConnection:this.props.liteConnection,elfPath:this.props.elfPath,onSelectedFreemasterVersion:this.props.onSelectedFreemasterVersion,changeElfPath:this.props.changeElfPath,changeLiteConnection:this.props.changeLiteConnection})),r.a.createElement(g,{width:"col-md-12",theme:this.props.theme},r.a.createElement("p",{className:"custom-font text-center"+("light"===this.props.theme?" text-dark":" text-white"),style:{marginBottom:"10px"}},"Charts Settings"),r.a.createElement(F,{onToggleAutoScaling:this.props.onToggleAutoScaling,onToggleAnimations:this.props.onToggleAnimations}))))))}}]),a}(r.a.Component),G=function(e){return e/1e3},L=function(e){return e/1e6},_=function(e){return 1e3*e},W=function(e){return e/1e3},H=function(e){return 1e6*e},z=function(e){return 1e3*e},q=function(e){return 9*e/5+32},J=function(e){return e+273.15},K=(a(165),a(166),Promise);if("undefined"===typeof K&&(K=root.Promise),void 0===K)throw"Promise is not supported! Use latest version node/browser or promise-polyfill";var X=function(e){return void 0===e},Z=Array.isArray,Q=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},Y=function(e){return"function"===typeof e},$=function(e){return"string"===typeof e},ee=function(e){if(Q(e)){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}return Z(e)?!e.length:!e},te=function(e,t){if(Z(e))return e.map(t);for(var a in e)e.hasOwnProperty(a)&&t(e[a])},ae={PARSE_ERROR:{code:-32700,message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},INVALID_REQUEST:{code:-32600,message:"Invalid Request. The JSON sent is not a valid Request object."},METHOD_NOT_FOUND:{code:-32601,message:"Method not found. The method does not exist / is not available."},INVALID_PARAMS:{code:-32602,message:"Invalid params. Invalid method parameter(s)."},INTERNAL_ERROR:{code:-32603,message:"Internal error. Internal JSON-RPC error."}};function ne(e,t,a){this.message=t||"",this.code=e||-32e3,Boolean(a)&&(this.data=a)}ne.prototype=new Error;var re=function(){var e=this,t={},a=0,n={};function r(e,t){var a,n=(a=e,JSON.parse(JSON.stringify(a)));return t&&(Q(t)&&t.hasOwnProperty("message")?n.data=t.message:$(t)&&(n.data=t),t instanceof ne&&(n={message:t.message,code:t.code},t.hasOwnProperty("data")&&(n.data=t.data))),n}function s(e){try{return function(e){return!!e.error}(e)?(s=e,void(t.hasOwnProperty(s.id)?t[s.id].reject(s.error):console.log("Unknown request",s))):function(e){return e.hasOwnProperty("result")&&e.hasOwnProperty("id")}(e)?(a=e,void(t.hasOwnProperty(a.id)?(t[a.id].resolve(a.result),delete t[a.id]):console.log("unknown request",a))):function(e){return!!e.method}(e)?function(e){if(console.log("handleRemoteRequest -- simple jrpc js"),!n.hasOwnProperty(e.method))return K.resolve({jsonrpc:"2.0",id:e.id,error:r(ae.METHOD_NOT_FOUND,{message:e.method})});try{var t;if(e.hasOwnProperty("params")){if("pass"==n[e.method].params)t=n[e.method].fn.call(n,e.params);else if(Z(e.params))t=n[e.method].fn.apply(n,e.params);else if(Q(e.params)){if(!(n[e.method].params instanceof Array))return K.resolve({jsonrpc:"2.0",id:e.id,error:r(ae.INVALID_PARAMS,"Undeclared arguments of the method "+e.method)});var a=[];if(n[e.method].params.forEach((function(t){e.params.hasOwnProperty(t)?(a.push(e.params[t]),delete e.params[t]):a.push(void 0)})),Object.keys(e.params).length>0)return K.resolve({jsonrpc:"2.0",id:e.id,error:r(ae.INVALID_PARAMS,{message:"Params: "+Object.keys(e.params).toString()+" not used"})});t=n[e.method].fn.apply(n,a)}}else t=n[e.method].fn();return e.hasOwnProperty("id")?(s=t)&&"function"===typeof s.then?t.then((function(t){return X(t)&&(t=!0),{jsonrpc:"2.0",id:e.id,result:t}})).catch((function(t){return{jsonrpc:"2.0",id:e.id,error:r(ae.INTERNAL_ERROR,t)}})):(X(t)&&(t=!0),K.resolve({jsonrpc:"2.0",id:e.id,result:t})):K.resolve()}catch(i){return K.resolve({jsonrpc:"2.0",id:e.id,error:r(ae.INTERNAL_ERROR,i)})}var s}(e):K.resolve({id:null,jsonrpc:"2.0",error:r(ae.INVALID_REQUEST)})}catch(i){return console.error("Resolver error:"+i.message,i),K.reject(i)}var a,s}function i(e,t){var a={jsonrpc:"2.0",method:e,params:t};return Q(t)&&!ee(t)&&(a.params=t),a}function l(e,n){var r={jsonrpc:"2.0",method:e,id:a+=1};return Q(n)&&!ee(n)&&(r.params=n),{promise:new K((function(e,n){t[a.toString()]={resolve:e,reject:n}})),message:r}}e.toStream=function(e){console.log("Need define the toStream method before use"),console.log(arguments)},e.dispatch=function(e,t,a){if($(e)&&"pass"==t&&Y(a))n[e]={fn:a,params:t};else if($(e)&&Z(t)&&Y(a))n[e]={fn:a,params:t};else{if(!($(e)&&Y(t)&&X(a)))throw new Error("Missing required argument: functionName - string, paramsNameFn - string or function");n[e]={fn:t,params:null}}},e.on=e.dispatch,e.off=function(e){delete n[e]},e.call=function(t,a){var n=l(t,a);return e.toStream(JSON.stringify(n.message)),n.promise},e.notification=function(t,a){e.toStream(JSON.stringify(i(t,a)))},e.batch=function(t){var a=[],n=[];return te(t,(function(e){if(e.hasOwnProperty("call")){var t=l(e.call.method,e.call.params);n.push(t.message),a.push(t.promise.then((function(e){return e}),(function(e){return e})))}else e.hasOwnProperty("notification")&&n.push(i(e.notification.method,e.notification.params))})),e.toStream(JSON.stringify(n)),K.all(a)},e.messageHandler=function(t){try{return function(t){var a=[];return Z(t)?te(t,(function(e){a.push(s(e))})):Q(t)&&a.push(s(t)),K.all(a).then((function(t){var a=[];return te(t,(function(e){X(e)||a.push(e)})),1===a.length?e.toStream(JSON.stringify(a[0])):a.length>1&&e.toStream(JSON.stringify(a)),t}))}(JSON.parse(t))}catch(a){return console.log("Error in messageHandler(): ",a),e.toStream(JSON.stringify({id:null,jsonrpc:"2.0",error:ae.PARSE_ERROR})),K.reject(a)}},e.customException=function(e,t,a){return new ne(e,t,a)}},se={};se.simple_jsonrpc=re,se.WebSocket=WebSocket;var ie=function(e,t,a,n){var r=new se.simple_jsonrpc,s=new se.WebSocket("ws://"+e);function i(e,t){var a=this;return new Promise((function(n,s){r.call(e,t).then((function(e){e.success?n(e):s(e.error)})).catch((function(e){a.OnServerError(e)}))}))}this.OnServerError=console.log,this.OnSocketOpen=t||console.log,this.OnSocketClose=a||console.log,this.OnSocketError=n||console.log,r.toStream=function(e){s.send(e)},s.onopen=function(e){this.OnSocketOpen(e)}.bind(this),s.onclose=function(e){this.OnSocketClose(e)}.bind(this),s.onerror=function(e){this.OnSocketError(e)}.bind(this),s.onmessage=function(e){r.messageHandler(e.data)},this.GetAppVersion=function(){return i.call(this,"GetAppVersion")},this.EnumCommPorts=function(e){return i.call(this,"EnumCommPorts",[e])},this.GetCommPortInfo=function(e){return i.call(this,"GetCommPortInfo",[e])},this.StartComm=function(e){return i.call(this,"StartComm",[e])},this.StopComm=function(){return i.call(this,"StopComm")},this.IsCommPortOpen=function(){return i.call(this,"IsCommPortOpen")},this.IsBoardDetected=function(){return i.call(this,"IsBoardDetected")},this.GetDetectedBoardInfo=function(){return i.call(this,"GetDetectedBoardInfo")},this.GetConfigParamU8=function(e){return i.call(this,"GetConfigParamU8",[e])},this.GetConfigParamULEB=function(e){return i.call(this,"GetConfigParamULEB",[e])},this.GetConfigParamString=function(e,t){return i.call(this,"GetConfigParamString",[e,t])},this.ReadIntVariable=function(e,t){return i.call(this,"ReadIntVariable",[e,t])},this.ReadUIntVariable=function(e,t){return i.call(this,"ReadUIntVariable",[e,t])},this.ReadFloatVariable=function(e){return i.call(this,"ReadFloatVariable",[e])},this.ReadDoubleVariable=function(e){return i.call(this,"ReadDoubleVariable",[e])},this.WriteIntVariable=function(e,t,a){return i.call(this,"WriteIntVariable",[e,t,a])},this.WriteUIntVariable=function(e,t,a){return i.call(this,"WriteUIntVariable",[e,t,a])},this.WriteFloatVariable=function(e,t){return i.call(this,"WriteFloatVariable",[e,t])},this.WriteDoubleVariable=function(e,t){return i.call(this,"WriteDoubleVariable",[e,t])},this.ReadIntArray=function(e,t,a){return i.call(this,"ReadIntArray",[e,t,a])},this.ReadUIntArray=function(e,t,a){return i.call(this,"ReadUIntArray",[e,t,a])},this.ReadFloatArray=function(e,t){return i.call(this,"ReadFloatArray",[e,t])},this.ReadDoubleArray=function(e,t){return i.call(this,"ReadDoubleArray",[e,t])},this.WriteIntArray=function(e,t,a){return i.call(this,"WriteIntArray",[e,t,a])},this.WriteUIntArray=function(e,t,a){return i.call(this,"WriteUIntArray",[e,t,a])},this.WriteFloatArray=function(e,t){return i.call(this,"WriteFloatArray",[e,t])},this.WriteDoubleArray=function(e,t){return i.call(this,"WriteDoubleArray",[e,t])},this.ReadELF=function(e){return i.call(this,"ReadELF",[e])},this.ReadTSA=function(){return i.call(this,"ReadTSA")},this.EnumSymbols=function(e){return i.call(this,"EnumSymbols",[e])},this.GetSymbolInfo=function(e){return i.call(this,"GetSymbolInfo",[e])},this.EnumVariables=function(e){return i.call(this,"EnumVariables",[e])},this.GetVariableInfo=function(e){return i.call(this,"GetVariableInfo",[e])},this.DefineVariable=function(e){return i.call(this,"DefineVariable",[e])},this.DeleteVariable=function(e){return i.call(this,"DeleteVariable",[e])},this.DeleteAllScriptVariables=function(){return i.call(this,"DeleteAllScriptVariables")},this.ReadVariable=function(e){return i.call(this,"ReadVariable",[e])},this.WriteVariable=function(e,t){return i.call(this,"WriteVariable",[e,t])},this.SetupOscilloscope=function(e,t){return i.call(this,"SetupOscilloscope",[e,t])},this.GetOscilloscopeData=function(e){return i.call(this,"GetOscilloscopeData",[e])},this.GetRecorderLimits=function(e){return i.call(this,"GetRecorderLimits",[e])},this.SetupRecorder=function(e,t,a,n){return i.call(this,"SetupRecorder",[e,t,a,n])},this.StartRecorder=function(e){return i.call(this,"StartRecorder",[e])},this.StopRecorder=function(e){return i.call(this,"StopRecorder",[e])},this.GetRecorderStatus=function(e){return i.call(this,"GetRecorderStatus",[e])},this.GetRecorderData=function(e){return i.call(this,"GetRecorderData",[e])},this.PipeOpen=function(e,t,a){return i.call(this,"PipeOpen",[e,t,a])},this.PipeClose=function(e){return i.call(this,"PipeClose",[e])},this.PipeFlush=function(e,t){return i.call(this,"PipeFlush",[e,t])},this.PipeSetDefaultRxMode=function(e,t){return i.call(this,"PipeSetDefaultRxMode",[e,t])},this.PipeSetDefaultStringMode=function(e){return i.call(this,"PipeSetDefaultStringMode",[e])},this.PipeGetRxBytes=function(e){return i.call(this,"PipeGetRxBytes",[e])},this.PipeGetTxBytes=function(e){return i.call(this,"PipeGetTxBytes",[e])},this.PipeGetTxFree=function(e){return i.call(this,"PipeGetTxFree",[e])},this.PipeGetRxBufferSize=function(e){return i.call(this,"PipeGetRxBufferSize",[e])},this.PipeGetTxBufferSize=function(e){return i.call(this,"PipeGetTxBufferSize",[e])},this.PipeWriteString=function(e,t,a,n){return i.call(this,"PipeWriteString",[e,t,a,n])},this.PipeWriteIntArray=function(e,t,a,n){return i.call(this,"PipeWriteIntArray",[e,t,a,n])},this.PipeWriteUIntArray=function(e,t,a,n){return i.call(this,"PipeWriteUIntArray",[e,t,a,n])},this.PipeWriteFloatArray=function(e,t,a){return i.call(this,"PipeWriteFloatArray",[e,t,a])},this.PipeWriteDoubleArray=function(e,t,a){return i.call(this,"PipeWriteDoubleArray",[e,t,a])},this.PipeReadString=function(e,t,a,n,r){return i.call(this,"PipeReadString",[e,t,a,n,r])},this.PipeReadIntArray=function(e,t,a,n,r){return i.call(this,"PipeReadIntArray",[e,t,a,n,r])},this.PipeReadUIntArray=function(e,t,a,n,r){return i.call(this,"PipeReadUIntArray",[e,t,a,n,r])},this.PipeReadFloatArray=function(e,t,a,n){return i.call(this,"PipeReadFloatArray",[e,t,a,n])},this.PipeReadDoubleArray=function(e,t,a,n){return i.call(this,"PipeReadDoubleArray",[e,t,a,n])},this.LocalFileOpen=function(e,t){return i.call(this,"LocalFileOpen",[e,t])},this.LocalFileClose=function(e){return i.call(this,"LocalFileClose",[e])},this.LocalFileReadString=function(e,t,a){return i.call(this,"LocalFileReadString",[e,t,a])},this.LocalFileWriteString=function(e,t,a,n){return i.call(this,"LocalFileWriteString",[e,t,a,n])},this.LogEnable=function(e,t){return i.call(this,"LogEnable",[e,t])},this.LogDisable=function(){return i.call(this,"LogDisable")},this.LogSetPattern=function(e){return i.call(this,"LogSetPattern",[e])},this.LogSetVerbosity=function(e){return i.call(this,"LogSetVerbosity",[e])},this.LogSetServices=function(e,t){return i.call(this,"LogSetServices",[e,t])},this.EnableExtraFeatures=function(e){var t=this;if(e)this.OnBoardDetected||(this.OnBoardDetected=function(){console.log("FreeMASTER Event received: OnBoardDetected()")}),this.OnCommPortStateChanged||(this.OnCommPortStateChanged=function(e){console.log("FreeMASTER Event received: OnCommPortStateChanged("+e+")")}),this.OnVariableChanged||(this.OnVariableChanged=function(e,t,a){console.log('FreeMASTER Event received: OnVariableChanged("'+e+'", '+t+", "+a+")")}),this.OnRecorderDone||(this.OnRecorderDone=function(){console.log("FreeMASTER Event received: OnRecorderDone()")}),r.dispatch("OnBoardDetected","pass",(function(e){return t.OnBoardDetected.apply(null,e)})),r.dispatch("OnCommPortStateChanged","pass",(function(e){return t.OnCommPortStateChanged.apply(null,e)})),r.dispatch("OnVariableChanged","pass",(function(e){return t.OnVariableChanged.apply(null,e)})),r.dispatch("OnRecorderDone","pass",(function(e){return t.OnRecorderDone.apply(null,e)})),this.StartStopComm=function(e){return i.call(this,"StartStopComm",[e])},this.EnableEvents=function(e){return i.call(this,"EnableEvents",[e])},this.SubscribeVariable=function(e,t){return i.call(this,"SubscribeVariable",[e,t])},this.UnSubscribeVariable=function(e){return i.call(this,"UnSubscribeVariable",[e])},this.DefineSymbol=function(e,t,a,n){return i.call(this,"DefineSymbol",[e,t,a,n])},this.GetSymbolInfo=function(e){return i.call(this,"GetSymbolInfo",[e])},this.GetStructMemberInfo=function(e,t){return i.call(this,"GetStructMemberInfo",[e,t])},this.DeleteAllScriptSymbols=function(){return i.call(this,"DeleteAllScriptSymbols")},this.RunStimulators=function(e){return i.call(this,"RunStimulators",[e])},this.StopStimulators=function(e){return i.call(this,"StopStimulators",[e])},this.Exit=function(){return i.call(this,"Exit")},this.ActivateWindow=function(){return i.call(this,"ActivateWindow")},this.SelectItem=function(e,t){return i.call(this,"SelectItem",[e,t])},this.OpenProject=function(e){return i.call(this,"OpenProject",[e])},this.IsBoardWithActiveContent=function(){return i.call(this,"IsBoardWithActiveContent")},this.EnumHrefLinks=function(e){return i.call(this,"EnumHrefLinks",[e])},this.EnumProjectFiles=function(e){return i.call(this,"EnumProjectFiles",[e])},this.SetPageReloadOnPortOpen=function(e){return i.call(this,"SetPageReloadOnPortOpen",[e])},this.GetPageReloadOnPortOpen=function(){return i.call(this,"GetPageReloadOnPortOpen")},this.PipeSetDefaultTxMode=function(e){return i.call(this,"PipeSetDefaultTxMode",[e])},this.GetAddressInfo=function(e,t){return i.call(this,"GetAddressInfo",[e,t])},this.DefineOscilloscope=function(e,t){return i.call(this,"DefineOscilloscope",[e,t])},this.DefineRecorder=function(e,t){return i.call(this,"DefineRecorder",[e,t])},this.SendCommand=function(e,t){return i.call(this,"SendCommand",[e,t])},this.GetCurrentRecorderState=function(){return i.call(this,"GetCurrentRecorderState")},this.GetCurrentRecorderData=function(){return i.call(this,"GetCurrentRecorderData")},this.GetCurrentRecorderSeries=function(e){return i.call(this,"GetCurrentRecorderSeries",[e])};else if(this.EnableEvents)throw"Can't disable ExtraFeatures after enabled once"}},le=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={pcm:null,boardConnected:!1,demoModeActive:!1,loading:!1,freemasterVersion:"lite",elfPath:"bms\\BMS_NXP.elf",liteConnection:{liteServerUrl:"localhost:8090",connString:"RS232;port=COM14;speed=115200;"},labels:[],packVoltage:[],packCurrent:[],packTemperature:[],packSoC:[],cellsNumber:6,cellsData:[],indicators:{blinkingStatus:[0,0,0,0,0,0,0,0],history:[]},units:{systemSocUnits:"%",systemVoltageUnits:"V",systemCurrentUnits:"A",systemTempUnits:"\xb0C",systemPowerUnits:"W",axis:{voltage:{"\xb5V":{min:0,max:5e6},mV:{min:0,max:5e3},V:{min:0,max:5}},current:{"\xb5A":{min:-2e6,max:2e6},mA:{min:-2e3,max:2e3},A:{min:-2,max:2}},balancing:{min:0,max:1.5},temp:{"\xb0C":{min:-40,max:80},"\xb0F":{min:-40,max:180},K:{min:230,max:355}}}},graphSettings:{graphAutoscaling:!0,graphAnimations:!0,maxOnGraphDataPoints:10},theme:"dark"},n.passedSeconds=0,n.updateRate=1e3,n.maxSavedGraphDataPoints=120,n.variables={name:{PackVoltage:"Pack_VoltageIn",PackCurrent:"Pack_CurrentIn",PackTemp:"Internal_Temperature",PackSoC:"PackSOC",CellVoltage:"Cell_Voltages",CellCurrent:"Cell_Current",CellTemp:"Cell_Temperature",CellSOC:"Cell_SOC",BMS_CellBalancing:"Cell_Balancing",BMS_Info_OUT:"BMS_Info_OUT"},type:{PackVoltage:{type:"float",size:4},PackCurrent:{type:"float",size:4},PackTemp:{type:"float",size:4},PackSoC:{type:"float",size:4},CellVoltage:{type:"float",size:4},CellCurrent:{type:"float",size:4},CellTemp:{type:"float",size:4},CellSOC:{type:"float",size:4},BMS_CellBalancing:{type:"uint",size:1},BMS_Info_OUT:{type:"uint",size:1}}},n.numberOfCellVariables=4,n.indicatorsNames=["Voltage Sensor","Over Current","High Temp","Low Temp","Over Voltage","Under Voltage","Contactor Fault for Charger","Contactor Fault for Inverter"],n.cellsPackButton=r.a.createRef(),n.onClickConnect=n.onClickConnect.bind(Object(u.a)(n)),n.onClickDisconnect=n.onClickDisconnect.bind(Object(u.a)(n)),n.defineVariables=n.defineVariables.bind(Object(u.a)(n)),n.readVariables=n.readVariables.bind(Object(u.a)(n)),n.readDEMOvars=n.readDEMOvars.bind(Object(u.a)(n)),n.defineDEMOVars=n.defineDEMOVars.bind(Object(u.a)(n)),n.changeUnit=n.changeUnit.bind(Object(u.a)(n)),n.proccesFaults=n.proccesFaults.bind(Object(u.a)(n)),n.setUpDesktopConnectionCheck=n.setUpDesktopConnectionCheck.bind(Object(u.a)(n)),n}return Object(m.a)(a,[{key:"changeUnit",value:function(e){"uV"===e?this.setState((function(t){return{units:Object(o.a)(Object(o.a)({},t.units),{},{systemVoltageUnits:"\xb5"+e.charAt(1)})}})):"mV"===e||"V"===e?this.setState((function(t){return{units:Object(o.a)(Object(o.a)({},t.units),{},{systemVoltageUnits:e})}})):"uA"===e?this.setState((function(t){return{units:Object(o.a)(Object(o.a)({},t.units),{},{systemCurrentUnits:"\xb5"+e.charAt(1)})}})):"mA"===e||"A"===e?this.setState((function(t){return{units:Object(o.a)(Object(o.a)({},t.units),{},{systemCurrentUnits:e})}})):"C"===e||"F"===e?this.setState((function(t){return{units:Object(o.a)(Object(o.a)({},t.units),{},{systemTempUnits:"\xb0"+e})}})):"K"===e&&this.setState((function(t){return{units:Object(o.a)(Object(o.a)({},t.units),{},{systemTempUnits:e})}}))}},{key:"defineVariables",value:function(e){var t=this.state.pcm,a=this.variables.name.PackVoltage,n=this.variables.name.PackCurrent,r=this.variables.name.PackTemp,s=this.variables.name.PackSoC,i=this.variables.name.CellVoltage,l=(this.variables.name.CellCurrent,this.variables.name.CellTemp),c=this.variables.name.CellSOC,m=this.variables.name.BMS_CellBalancing,u=this.variables.name.BMS_Info_OUT,h=[];this.cellsData=[],this.labels=[],this.packVoltage=[],this.packCurrent=[],this.packTemperature=[],this.packSoC=[],h.push.apply(h,[t.DefineVariable(Object(o.a)({name:a,addr:a},this.variables.type.PackVoltage)),t.DefineVariable(Object(o.a)({name:n,addr:n},this.variables.type.PackCurrent)),t.DefineVariable(Object(o.a)({name:r,addr:r},this.variables.type.PackTemp)),t.DefineVariable(Object(o.a)({name:s,addr:s},this.variables.type.PackSoC))]);for(var p=0;p<8;p++)h.push.apply(h,[t.DefineVariable(Object(o.a)({name:u+"[".concat(p,"]"),addr:u+"[".concat(p,"]")},this.variables.type.BMS_Info_OUT))]);for(var d=0;d<e;d++)this.cellsData.push({labels:[],voltage:[],balancing:[],current:[],temp:[],soc:[]}),h.push.apply(h,[t.DefineVariable(Object(o.a)({name:i+"[".concat(d,"]"),addr:i+"[".concat(d,"]")},this.variables.type.CellVoltage)),t.DefineVariable(Object(o.a)({name:m+"[".concat(d,"]"),addr:m+"[".concat(d,"]")},this.variables.type.BMS_CellBalancing)),t.DefineVariable(Object(o.a)({name:l+"[".concat(d,"]"),addr:l+"[".concat(d,"]")},this.variables.type.CellTemp)),t.DefineVariable(Object(o.a)({name:c+"[".concat(d,"]"),addr:c+"[".concat(d,"]")},this.variables.type.CellSOC))]);return Promise.all(h)}},{key:"readVariables",value:function(){var e=this,t=this.state.pcm,a=this.variables.name.PackVoltage,n=this.variables.name.PackCurrent,r=this.variables.name.PackTemp,s=this.variables.name.PackSoC,i=this.variables.name.CellVoltage,l=(this.variables.name.CellCurrent,this.variables.name.CellTemp),o=this.variables.name.CellSOC,c=this.variables.name.BMS_CellBalancing,m=this.variables.name.BMS_Info_OUT,u=[];u.push.apply(u,[t.ReadVariable(a),t.ReadVariable(n),t.ReadVariable(r),t.ReadVariable(s)]);for(var h=0;h<8;h++)u.push.apply(u,[t.ReadVariable(m+"[".concat(h,"]"))]);for(var p=0;p<this.state.cellsNumber;p++)u.push.apply(u,[t.ReadVariable(i+"[".concat(p,"]")),t.ReadVariable(c+"[".concat(p,"]")),t.ReadVariable(l+"[".concat(p,"]")),t.ReadVariable(o+"[".concat(p,"]"))]);Promise.all(u).then((function(t){for(var a=t.slice(12).map((function(e){return e.data})),n=0;n<a.length;n+=e.numberOfCellVariables){var r=e.cellsData[n/e.numberOfCellVariables].labels,s=e.cellsData[n/e.numberOfCellVariables].voltage,i=e.cellsData[n/e.numberOfCellVariables].balancing,l=e.cellsData[n/e.numberOfCellVariables].temp,o=e.cellsData[n/e.numberOfCellVariables].soc;switch(r.push(e.passedSeconds),e.state.units.systemVoltageUnits){case"\xb5V":s.push(H(a[n]));break;case"mV":s.push(z(a[n]));break;case"V":s.push(a[n])}switch(i.push(a[n+1]),e.state.units.systemTempUnits){case"\xb0C":l.push(a[n+2]);break;case"\xb0F":l.push(q(a[n+2]));break;case"K":l.push(J(a[n+2]))}o.push(a[n+3]),s.length>e.maxSavedGraphDataPoints&&(r.splice(0,r.length-e.maxSavedGraphDataPoints),s.splice(0,s.length-e.maxSavedGraphDataPoints),i.splice(0,i.length-e.maxSavedGraphDataPoints),l.splice(0,l.length-e.maxSavedGraphDataPoints),o.splice(0,o.length-e.maxSavedGraphDataPoints))}switch(e.state.units.systemVoltageUnits){case"\xb5V":e.packVoltage.push(H(t[0].data));break;case"mV":e.packVoltage.push(z(t[0].data));break;case"V":e.packVoltage.push(t[0].data)}switch(e.state.units.systemCurrentUnits){case"\xb5A":e.packCurrent.push(H(t[1].data));break;case"mA":e.packCurrent.push(z(t[1].data));break;case"A":e.packCurrent.push(t[1].data)}switch(e.state.units.systemTempUnits){case"\xb0C":e.packTemperature.push(t[2].data);break;case"\xb0F":e.packTemperature.push(q(t[2].data));break;case"K":e.packTemperature.push(J(t[2].data))}e.packSoC.push(t[3].data),e.labels.push(e.passedSeconds),e.packVoltage.length>e.maxSavedGraphDataPoints&&(e.packVoltage.splice(0,e.packVoltage.length-e.maxSavedGraphDataPoints),e.packCurrent.splice(0,e.packCurrent.length-e.maxSavedGraphDataPoints),e.packTemperature.splice(0,e.packTemperature.length-e.maxSavedGraphDataPoints),e.packSoC.splice(0,e.packSoC.length-e.maxSavedGraphDataPoints),e.labels.splice(0,e.labels.length-e.maxSavedGraphDataPoints)),e.setState((function(a){return{labels:e.labels,packVoltage:e.packVoltage,packCurrent:e.packCurrent,packTemperature:e.packTemperature,packSoC:e.packSoC,cellsData:e.cellsData,indicators:e.proccesFaults(a,t)}})),e.passedSeconds++,e.readVarsTimeout=setTimeout(e.readVariables,e.updateRate)})).catch((function(t){console.log(t),d.b.error(" Reading the variables failed."),clearTimeout(e.readVarsTimeout),e.setState((function(){return{boardConnected:!1}})),e.setUpDesktopConnectionCheck()}))}},{key:"proccesFaults",value:function(e,t){var a=this,n=new Date,r=(n.getHours()<10?"0":"")+n.getHours()+":"+(n.getMinutes()<10?"0":"")+n.getMinutes()+":"+(n.getSeconds()<10?"0":"")+n.getSeconds(),s=Object(l.a)(Array(8).keys()).map((function(e){return e+4})).map((function(e){return t[e].data})),i=e.indicators.blinkingStatus.map((function(e,t){return e!==s[t]?1:0})),o=[];return i.forEach((function(t,n){t&&o.push({time:r,from:e.indicators.blinkingStatus[n],to:s[n],name:a.indicatorsNames[n]})})),{blinkingStatus:s,history:[].concat(Object(l.a)(e.indicators.history),o)}}},{key:"defineDEMOVars",value:function(e){this.cellsData=[];for(var t=0;t<e;t++)this.cellsData.push({labels:[],voltage:[],balancing:[],current:[],temp:[],soc:[]})}},{key:"readDEMOvars",value:function(){for(var e=this,t=0;t<this.state.cellsNumber;t++){var a={cellVoltage:1e6*(5*Math.random()+0),cellCurrent:1e3*(4*Math.random()-2),cellTemp:110*Math.random()-40,cellSOC:Math.random(),cellBalancing:Math.round(Math.random())};switch(this.state.units.systemVoltageUnits){case"\xb5V":a.cellVoltage=a.cellVoltage;break;case"mV":a.cellVoltage=G(a.cellVoltage);break;case"V":a.cellVoltage=L(a.cellVoltage)}switch(this.state.units.systemCurrentUnits){case"\xb5A":a.cellCurrent=_(a.cellCurrent);break;case"mA":a.cellCurrent=a.cellCurrent;break;case"A":a.cellCurrent=W(a.cellCurrent)}switch(this.state.units.systemTempUnits){case"\xb0C":a.cellTemp=a.cellTemp;break;case"\xb0F":a.cellTemp=q(a.cellTemp);break;case"K":a.cellTemp=J(a.cellTemp)}this.cellsData[t].labels.push(this.passedSeconds),this.cellsData[t].voltage.push(a.cellVoltage),this.cellsData[t].current.push(a.cellCurrent),this.cellsData[t].balancing.push(a.cellBalancing),this.cellsData[t].temp.push(a.cellTemp),this.cellsData[t].soc.push(a.cellSOC),this.cellsData[t].labels.length>this.maxSavedGraphDataPoints&&(this.cellsData[t].labels.splice(0,this.cellsData[t].labels.length-this.maxSavedGraphDataPoints),this.cellsData[t].voltage.splice(0,this.cellsData[t].voltage.length-this.maxSavedGraphDataPoints),this.cellsData[t].current.splice(0,this.cellsData[t].current.length-this.maxSavedGraphDataPoints),this.cellsData[t].balancing.splice(0,this.cellsData[t].balancing.length-this.maxSavedGraphDataPoints),this.cellsData[t].temp.splice(0,this.cellsData[t].temp.length-this.maxSavedGraphDataPoints),this.cellsData[t].soc.splice(0,this.cellsData[t].soc.length-this.maxSavedGraphDataPoints))}switch(this.state.units.systemVoltageUnits){case"\xb5V":this.packVoltage.push(1e6*(5*Math.random()+0));break;case"mV":this.packVoltage.push(G(1e6*(5*Math.random()+0)));break;case"V":this.packVoltage.push(L(1e6*(5*Math.random()+0)))}switch(this.state.units.systemCurrentUnits){case"\xb5A":this.packCurrent.push(_(1e3*(4*Math.random()-2)));break;case"mA":this.packCurrent.push(1e3*(4*Math.random()-2));break;case"A":this.packCurrent.push(W(1e3*(4*Math.random()-2)))}switch(this.state.units.systemTempUnits){case"\xb0C":this.packTemperature.push(110*Math.random()-40);break;case"\xb0F":this.packTemperature.push(q(110*Math.random()-40));break;case"K":this.packTemperature.push(J(110*Math.random()-40))}this.packSoC.push(Math.random()),this.labels.push(this.passedSeconds),this.packVoltage.length>this.maxSavedGraphDataPoints&&(this.packVoltage.splice(0,this.packVoltage.length-this.maxSavedGraphDataPoints),this.packCurrent.splice(0,this.packCurrent.length-this.maxSavedGraphDataPoints),this.packTemperature.splice(0,this.packTemperature.length-this.maxSavedGraphDataPoints),this.packSoC.splice(0,this.packSoC.length-this.maxSavedGraphDataPoints),this.labels.splice(0,this.labels.length-this.maxSavedGraphDataPoints)),this.setState((function(t){return{labels:e.labels,packVoltage:e.packVoltage,packCurrent:e.packCurrent,packTemperature:e.packTemperature,packSoC:e.packSoC,cellsData:e.cellsData,indicators:e.proccesFaults(t,Object(l.a)(Array(12).keys()).map((function(e){return 4===e?{data:Math.round(Math.random())}:{data:0}})))}})),this.passedSeconds++,this.readDEMOVarsTimeout=setTimeout(this.readDEMOvars,900)}},{key:"onClickDisconnect",value:function(){var e=this,t=this.state.pcm;clearTimeout(this.readVarsTimeout),t.StopComm().then((function(){d.b.success(" Disconnected."),e.setState((function(){return{boardConnected:!1,pcm:null}})),e.setUpDesktopConnectionCheck()})).catch((function(){d.b.error(" Stopping the communication failed.")}))}},{key:"onClickConnect",value:function(e){var t=this;if(!this.state.loading)if(this.state.demoModeActive)d.b.error(" Disable demo mode before connecting to the board.");else{var a=(null===e||void 0===e?void 0:e.liteServer)||this.state.liteConnection.liteServerUrl,n=(null===e||void 0===e?void 0:e.connString)||this.state.liteConnection.connString;this.state.pcm=new ie(a,(function(){var e=t.state.pcm;"desktop"===t.state.freemasterVersion?e.StartComm("preset").then((function(){d.b.success(" Successfully connected."),t.passedSeconds=0,t.labels=[],t.cellsData=[],t.packVoltage=[],t.packCurrent=[],t.packTemperature=[],t.packSoC=[];for(var e=0;e<t.state.cellsNumber;e++)t.cellsData.push({labels:[],voltage:[],balancing:[],current:[],temp:[],soc:[]});t.readVariables(),t.setState((function(){return{boardConnected:!0,loading:!1}}))})):e.StartComm(n).then(e.IsBoardDetected).then((function(t){if(!0===t.data)return e.GetDetectedBoardInfo();throw new Error("Board not detected!")})).then((function(a){return e.ReadELF(t.state.elfPath)})).then((function(){d.b.success(" Successfully connected."),t.defineVariables(t.state.cellsNumber).then((function(){t.passedSeconds=0,t.readVariables(),t.setState((function(){return{boardConnected:!0,loading:!1}}))}))})).catch((function(e){console.log(e),d.b.error(" An error has occurred, check the connection parameters."),t.setState((function(){return{loading:!1}}))}))}),(function(){d.b.error(" Connection Closed."),clearTimeout(t.readVarsTimeout),t.setState((function(){return{boardConnected:!1,loading:!1}}))}),(function(){d.b.error(" An error has occurred, check the connection."),clearTimeout(t.readVarsTimeout),t.setState((function(){return{boardConnected:!1,loading:!1}}))})),this.setState((function(){return{loading:!0}}))}}},{key:"setUpDesktopConnectionCheck",value:function(){var e=this;!function t(){if(!1===e.state.boardConnected)var a=new ie("localhost:41000",(function(){a.IsCommPortOpen().then((function(a){!0===a.data?e.onClickConnect():setTimeout(t,1e3)}))}))}()}},{key:"componentDidMount",value:function(){window.$('[data-toggle="tooltip"]').tooltip(),this.setUpDesktopConnectionCheck()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.readVarsTimeout),clearTimeout(this.readDEMOVarsTimeout)}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"content-area"},r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{id:"main-container",className:"mt-3"},r.a.createElement("div",{id:"header-container",className:"row"},r.a.createElement("div",{className:"col-lg-12"},r.a.createElement("div",{className:"row"},r.a.createElement("h2",{className:"ml-3"},"Battery Management System ",this.state.demoModeActive?"(Demo mode active)":"")),r.a.createElement("div",{className:"row"},r.a.createElement(b,{text:"Dashboard",active:"true",controls:"#dashboard-container",icon:"fa fa-sliders",disabled:!1}),r.a.createElement(b,{buttonRef:this.cellsPackButton,text:"Cells Pack",controls:"#cell-pack-container",icon:"fa fa-list",disabled:!1}),r.a.createElement(b,{text:"Raw Data",controls:"#raw-data-container",icon:"fa fa-table",disabled:!1}),r.a.createElement(b,{text:"System Configuration",controls:"#chemistry-container",icon:"fa fa-flask",disabled:!1}),r.a.createElement("a",{className:"btn btn-large white-text-button btn-primary",style:{position:"absolute",right:"15px"},role:"button",onClick:this.state.boardConnected?this.onClickDisconnect:this.onClickConnect},!1===this.state.boardConnected&&!0===this.state.loading&&r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"spinner-grow mr-2",style:{width:"1.4rem",height:"1.4rem"},role:"status","aria-hidden":"true"}),"Connecting"),!0===this.state.boardConnected&&!1===this.state.loading&&r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"fa fa-exchange mr-2",style:{width:"1.4rem",height:"1.4rem"}}),"Disconnect"),!1===this.state.boardConnected&&!1===this.state.loading&&r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"fa fa-exchange mr-2",style:{width:"1.4rem",height:"1.4rem"}}),"Connect"))))),r.a.createElement(f,{active:"true",id:"dashboard-container",dataParent:"#main-container"},r.a.createElement(V,{cellsNumber:this.state.cellsNumber,data:{labels:this.state.labels,packVoltage:this.state.packVoltage,packCurrent:this.state.packCurrent,packTemperature:this.state.packTemperature,packSoC:this.state.packSoC},indicatorsNames:this.indicatorsNames,blinkingStatus:this.state.indicators.blinkingStatus,indicatorsHistory:this.state.indicators.history,clickCellsPackTab:function(){e.cellsPackButton.current.click()},boardConnected:this.state.boardConnected,demoModeActive:this.state.demoModeActive,units:this.state.units,theme:this.state.theme,graphSettings:this.state.graphSettings})),r.a.createElement(f,{id:"cell-pack-container",dataParent:"#main-container"},r.a.createElement(A,{cellsNumber:this.state.cellsNumber,cellsData:this.state.cellsData,passedSeconds:this.passedSeconds,numberOfCellVariables:this.numberOfCellVariables,units:this.state.units,theme:this.state.theme,graphSettings:this.state.graphSettings})),r.a.createElement(f,{id:"raw-data-container",dataParent:"#main-container"},r.a.createElement(U,{cellsNumber:this.state.cellsNumber,cellsData:this.state.cellsData,units:this.state.units,theme:this.state.theme})),r.a.createElement(f,{id:"chemistry-container",dataParent:"#main-container"},r.a.createElement(B,{boardConnected:this.state.boardConnected,demoModeActive:this.state.demoModeActive,liteConnection:this.state.liteConnection,changeLiteConnection:function(t){e.setState((function(){return{liteConnection:{liteServerUrl:t.liteServerUrl||e.state.liteConnection.liteServerUrl,connString:t.connString||e.state.liteConnection.connString}}}))},onSelectedFreemasterVersion:function(t){e.setState((function(){return{freemasterVersion:t}}))},elfPath:this.state.elfPath,changeElfPath:function(t){e.setState((function(){return{elfPath:t}}))},onToggleAutoScaling:function(){e.setState((function(e){return{graphSettings:Object(o.a)(Object(o.a)({},e.graphSettings),{},{graphAutoscaling:!e.graphSettings.graphAutoscaling})}}))},onToggleAnimations:function(){e.setState((function(e){return{graphSettings:Object(o.a)(Object(o.a)({},e.graphSettings),{},{graphAnimations:!e.graphSettings.graphAnimations})}}))},onChangeMaxOnGraphDataPoints:function(t){e.setState((function(e){return{graphSettings:Object(o.a)(Object(o.a)({},e.graphSettings),{},{maxOnGraphDataPoints:t})}}))},changeCellsNumber:function(t){d.b.info(" Cells number changed to "+t,{autoClose:3e3}),e.state.pcm?e.defineVariables(t).then((function(){e.setState((function(){return{cellsNumber:t}}))})):(e.defineDEMOVars(t),e.setState((function(){return{cellsNumber:t}})))},cellsNumber:this.state.cellsNumber,cellsData:this.state.cellsData,data:{labels:this.state.labels,packVoltage:this.state.packVoltage,packCurrent:this.state.packCurrent,packTemperature:this.state.packTemperature,packSoC:this.state.packSoC},triggerDemoMode:function(){e.labels=[],e.cellsData=[],e.packVoltage=[],e.packCurrent=[],e.packTemperature=[],e.packSoC=[],e.passedSeconds=0,!1===e.state.demoModeActive?(e.defineDEMOVars(e.state.cellsNumber),e.readDEMOvars(),d.b.info(" Demo mode switched ON.",{autoClose:3e3})):(clearTimeout(e.readDEMOVarsTimeout),d.b.info(" Demo mode switched OFF.",{autoClose:3e3})),e.setState((function(e){return{demoModeActive:!e.demoModeActive}}))},changeUnit:this.changeUnit,units:this.state.units,theme:this.state.theme,changeApplicationTheme:function(t){e.setState((function(){return{theme:t}}))}})))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-lg-12 mt-2 text-center"},"\xa9 2020 NXP"))),r.a.createElement(d.a,null))}}]),a}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(le,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},27:function(e,t,a){},57:function(e,t,a){e.exports=a(167)},62:function(e,t,a){},63:function(e,t,a){},65:function(e,t,a){}},[[57,1,2]]]);
//# sourceMappingURL=main.ed484f37.chunk.js.map